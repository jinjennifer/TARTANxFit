{% extends "TxFApp/base.html" %}
{% block content %}

<!-- Display flash messages if there are any -->
{% include 'TxFApp/flash_message.html' %}

<div class="row">
{% with class.class_schedule as groupx %}
	<div class="col-xs-12">
	    <h3>
	        {{ groupx.class_type.name }}
	    </h3>
	</div>
</div>
<div class="row">
	<div class="col-xs-12 col-sm-8 dot-border">
		<i class="fa fa-clock-o icon"></i> {{groupx.start_time}} - {{groupx.end_time}}<br>
		<i class="fa fa-calendar icon"></i> {{day}}, {{class.date | date:'M d'}} <br>
		<i class="fa fa-map-marker icon"></i> {{groupx.location}}<br>
		<i class="fa fa-user icon"></i> {{groupx.instructor.user.first_name}}<br>
		<i class="fa fa-star icon"></i> {{groupx.points}}<br>
	</div>
	<div class="col-xs-12 col-sm-4">
		<div class="btn btn-lg btn-block btn-primary" onclick="facebookShare();"><i class="fa fa-share icon"></i> SHARE</div>
        {% if yet_to_happened %}
        {% if already_rsvped %}
        <form class="" action="{% url 'TxFApp:details' class.id %}" method="post">
            <input name="date" type="hidden" value="{{class.date}}"/>
            <input name="class_id" type="hidden" value="{{class.id}}"/>
                <button id="unrsvpButton" type ="submit" class='btn btn-lg btn-block btn-danger'><i class="fa fa-times fa-lg"></i> Cancel RSVP</button>
            {% csrf_token %}
        </form>
        {% else %}
        <form class="" action="{% url 'TxFApp:details' class.id %}" method="post">
            <input name="date" type="hidden" value="{{class.date}}"/>
            <input name="class_id" type="hidden" value="{{class.id}}"/>
                <button id="rsvpButton" type ="submit" class='btn btn-lg btn-block btn-success'><i class="fa fa-plus fa-lg"></i> RSVP</button>
            {% csrf_token %}
        </form>
        {% endif %}
        {% endif %}



	</div>
</div>
<div class="row">
    <div class="col-xs-12">
    	<h3>Description</h3>
    <div>
</div>
<div class="row">
    <div class="col-xs-12">
    	<p>{{groupx.class_type.description}}</p>
    <div>
</div>
{% endwith %}
<div class="row">
    <div class="col-xs-12">
    	<h3>Friends Attending</h3>
    </div>
</div>
<br>
<div class="row" id="friends-attending">
    <!-- Will be populated by facebook.js -->
</div>

{% if role == 'admin' %}
<div class="row">
    <div class="col-xs-12">
        <h3>Students Attending</h3>
    </div>
</div>
<br>
<div class="row" id="students-attending">
    <div class="list-group">
        {% for class in classes %}
        {% with class.course.class_schedule as c %}
            <a href="/classes/{{ class.course.id }}/" class="list-group-item">
                <h4 class="list-group-item-heading"> {{c.class_type.name}} </h4>
                <div class="row">
                <p class="list-group-item-text col-xs-8"><i class="fa fa-calendar icon"></i> {{class.course.date}} <br>
                <i class="fa fa-clock-o icon"></i> {{c.start_time | time:'g:i a'}} - {{c.end_time | time:'g:i a'}} </p>
            {% if class.course.has_occurred %}
            <form class="list-group-item-text col-xs-4" action="/account" method="post">
                <input name="class_id" type="hidden" value="{{rsvp.course.id}}"/>
                <input name="type" type="hidden" value="attended"/>
                    <button id="rsvpButton" type ="submit" class='btn btn-success'><i class="fa fa-check fa-lg"></i> I attended!</button>
                {% csrf_token %}
            </form>
            {% else %} <!-- hasnt occured, option to cancel class -->
                <button id="unrsvpButton" type="submit" class='btn btn-danger'><i class="fa fa-times fa-lg"></i> Cancel Class</button>
            {% endif %}
        </div>
            </a>
        {% endwith %}
        {% empty %}
            <div class="col-xs-12">
        <p>You are currently not teaching any Group X classes. Add a new class below.</p>
    <div>
        {% endfor %}
    </div>

</div>
{% endif %}

<div class="empty-placeholder">
</div>
{% endblock %}